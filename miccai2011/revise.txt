==============================================================================
R1: 1. Our method is a Bayesian approach, i.e., an MRF prior on the labels and
maximum a posteriori segmentation. The Bayesian framework is very important,
because this enforces spatial coherence in the functional networks. This is the
main goal of the paper. Second, we use priors on the parameters (kappa, sigma)
to prevent degenerate solutions, e.g., a single label dominating the entire
image.

2. We agree this sentence was unclear. We empirically tune the hyperparameters
for kappa/sigma distributions and have found the results to be robust to
specific choices of the hyperparameters. We'll add this in the paper.

3. The neighborhood is the usual 6 adjacent voxels, which does not overly smooth
across boundaries. Previous works (e.g., [4, 8]) have demonstrated the
advantages of MRF's over Gaussian smoothing in preserving segment boundaries.

4. We chose 3 time points because they can be visualized on a 2-sphere.  The
goal was not to synthesize realistic brain data, but rather have a ground truth
comparison of MCEM and a mode-approximation method (ICM here). As described in
the text, the time series were generated by sampling from von-Mises Fisher, and
these clusters are plotted in Fig 1.

5. For ICA we choose 16 components. The component map is converted to a z score
and thresholded at 1. Even spatial ICA (Calhoun 2001) does not take into account
spatial correlations (smoothness), it only ensures spatially independent
component maps. It still often produces spurious/scattered labels. We agree that
the single-subject visual and dorsal attention networks have more variability,
but group analysis (future work) will alleviate this issue.

R2: Validation: we have results for 16 subjects and only show 3 of them because
of space limitations. We will add an entropy measure of consistency amongst the
16 subjects (our method vs. ICA). Our approach naturally extends to group
analysis using hierarchical Bayesian concepts (future work).

R3: Our work is related to Golland 2008, which we referenced, as we both use
von-Mises Fisher. However, the main contribution of our paper is the MRF spatial
prior, which entails MCEM. Golland uses no spatial prior.  Also, the MCEM is not
costly (only a few minutes).

Selecting the number of components is a model-selection problem and is future
work.

Since there is no ground truth, we compared our results to those of ICA
qualitatively to show that our method has more biologically-plausible spatial
coherence.
 

=============================================================================
------------------------ Submission 1219, Review 1 ------------------------

Title: Monte Carlo Expectation Maximization with Hidden Markov Models to Detect
Functional Networks in Resting-State fMRI

Reviewer:           External

The review

  The authors proposed a new statistical framework to partition the whole
  brain into different functional networks based on rs-fMRI data. The
  problem of defining functional networks is highly important and the
  proposed method utilizing MCEM algorithm and hidden markov model is
  interesting. However, the simulation used to test the performance of the
  proposed method is overly simplistic and the comparison with other
  methods is not particularly convincing.
  Specific comments:
  1.   The authors claimed to do Bayesian inference, whereas they are using
  MCEM algorithm to calculate the maximum likelihood estimators in their
  hidden markov model. Throughout the paper, Bayesian is not something
  really important. It seems one does not need to specify any prior in
  Section 2.2.

  2.   In section 2.2, the authors said “We carefully choose hyperparameter
  values to ensure that the results are not very sensitive to the
  hyperparameter values”. Is this a circular claim? How exactly did the
  authors do this?

  3.   In section 2.1, when the authors derived the Markov model, what is
  exactly the “neighborhood system” used? Given the spatial smoothness
  imposed (controlled by â) in this model, is it possible that the
  boundaries between different clusters will also be blurred?

  4.   The simulation section is overly simplistic. What’s the rational for
  using only 3 time points for the synthetic data as rs-fMRI data usually
  have hundreds of time points. How exactly were the time series in each
  cluster constructed? What does the similarity structure look like among
  different clusters? More importantly, since spatial smoothing in rs-fMRI
  data preprocessing is common and was also applied to the real data
  experiment in this study, the simulation should also include the tests
  under different spatial smoothing scenarios.

  5.   For real data results, first the sample size is too small to
  demonstrate the robustness of the proposed method. Currently, rs-fMRI
  data are freely available online in thousands so more data needs to be
  tested. Even with three subjects, the visual and dorsal attention
  networks seem to change dramatically from subject to subject. Moreover,
  the comparison with ICA is not totally fair. The results showed that ICA
  split the default network into two components, but what was the number of
  ICs used for the analysis? Did the author choose the optimal number since
  most adult studies report default network in one component. Also, the
  authors pointed out the “small, likely false-positive regions of
  connectivity”, but what is the magnitude/size threshold applied to get
  the ICA map since this kind of scattered activity highly depends on the
  threshold chosen. Moreover, the claim that “The ICA result shows the
  disadvantage of ignoring spatial information.” is too strong and not
  correct since spatial ICA does consider spatial independence on top of
  functional similarity. Finally, what do other components look like in
  ICA, how do they compare with the results of the proposed method?


  Minor issues:

  Figure. 3 should not be located among the references.

------------------------ Submission 1219, Review 2 ------------------------
Reviewer:           External

The review

  In this paper, authors have applied a new framework for partitioning the
  cortex into distinct functional networks based on resting-state fMRI. It
  is an interesting application.  There are four relatively robust
  functional networks were detected. However, the authors should explain
  how to define the consistency  of  the results. Moreover, the individual
  difference looks like a litte larger. The results would be more convinced
  with large sample. The authors should show a group results.


------------------------ Submission 1219, Review 3 ------------------------
Reviewer:           External

The review

  The paper 1219, entitled “Monte Carlo EM with HMM to Detect Functional
  networks in resting state fMRI ” presents a clustering algorithm based on
  mixture modeling to identify stable structure in resting-state data. The
  Bayesian estimation algorithm is presented in detail,  and an experiment
  on real data is presented, without any quantitative assessment of the
  result.

  While the algorithm is interesting and potentially useful, I regard this
  work as not really mature, because essential questions are simply not
  addressed : how to select the number of components to extract ? How to
  assess the quality of the result/of the algorithm ? Is there any
  advantage of the proposed approach ?  If I remember well, a paper by
  Golland et al. (MICCAI'07) was already doing almost the same thing. The
  only point  novelty is that the E step is performed by (costly)
  simulation.


  Minor points
  “does not require specification of a seed”: but requires the
  specification of a number of networks.
  I would encourage the authors to consider Variational bayes
  implementations for this problem.
  Kappa_l is drawn from a normal law, which is particularly ugly, as it has
  to be positive. Normally, one uses (inverse-) gamma laws for this kind of
  parameter.
  “\tilde{Q}_p does not depend on \kappa”, I guess.
  “MCEM is solution is close to the ground truth”: please back up this kind
  of statement with quantitative information.
  Smoothing 8*8*8 (mm?) kernel: so the correlation structure that matches
  the Markov hypothesis of the author is largely artefactual. This is not
  serious.
  Please provide quantitative assessment on the  real data (comparison with
  ICA...)

------------------------ Submission 1219, Review 5 ------------------------
Reviewer:           Secondary

Summary of the reviews

  While the modeling is attractive, the level of novelty is moderate, and
  the evaluation is somewhat weak.

